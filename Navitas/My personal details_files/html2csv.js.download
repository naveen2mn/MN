jQuery.fn.table2CSV=function(l){var l=jQuery.extend({separator:",",header:[],fileName:"test",delivery:"popup"},l);var j=[];var a=[];var d=this;var e=l.header.length;var k=[];if(e>0){for(var h=0;h<e;h++){k[k.length]=c(l.header[h])}}else{$(d).filter(":visible").find("th").each(function(){if($(this).css("display")!="none"){k[k.length]=c($(this).html())}})}g(k);$(d).find("tr").each(function(){var i=[];$(this).filter(":visible").find("td").each(function(){if($(this).css("display")!="none"){i[i.length]=c($(this).html())}});g(i)});if(l.delivery=="popup"){var f=j.join("\n");return b(f)}else{var f=j.join("\n");return f}function g(i){var n=i.join("");if(i.length>0&&n!=""){var m=i.join(l.separator);j[j.length]=m}}function c(m){var n=new RegExp(/["]/g);var i=m.replace(n,"ï¿½");var n=new RegExp(/\<[^\<]+\>/g);var i=i.replace(n,"");i=i.replace("&amp;","&");if(i==""){return""}if(i=="-"){return""}return'"'+i+'"'}function b(i){var m=l.fileName;downloadHTMLInCSV(i,m);return false}};
